<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>Call {{ call.phone }}</title>
  <style>
    :root{--fg:#0b0b0f;--muted:#6b7280;--accent:#2563eb;--bg:#fff;--chip:#eef2ff;--card:#f8fafc}
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--bg);color:var(--fg);font:16px/1.45 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif}
    .wrap{max-width:760px;margin:0 auto;padding:16px}
    header{display:flex;align-items:center;gap:8px}
    a.back{color:var(--accent);text-decoration:none}
    h1{font-size:18px;margin:0}
    .meta{margin:12px 0;color:var(--muted);font-size:13px}
    .block{background:var(--card);border:1px solid #e5e7eb;border-radius:12px;padding:12px;margin:12px 0}
    .block h2{font-size:14px;margin:0 0 8px 0;color:#111827}
    .messages{display:flex;flex-direction:column;gap:10px}
    .msg{display:flex;gap:10px}
    .role{min-width:86px;font-weight:600;color:#111827}
    .bubble{flex:1;background:#fff;border:1px solid #e5e7eb;border-radius:10px;padding:10px}
    .kv{display:grid;grid-template-columns:130px 1fr;gap:6px 10px}
    .chip{display:inline-block;background:var(--chip);color:#3730a3;border-radius:999px;padding:4px 10px;font-size:12px}
    .grid{display:grid;grid-template-columns:1fr;gap:10px}
    @media (min-width:720px){.grid{grid-template-columns:1fr 1fr}}
  </style>
  <link rel="icon" href="data:,">
</head>
<body>
  <div class="wrap">
    <header>
      <a class="back" href="/ui">← Back</a>
      <h1>{{ call.phone }}</h1>
    </header>
    <div class="meta">
      {% if call.info and call.info.timestamp %}
        Started {{ call.info.timestamp }}
      {% endif %}
    </div>

    <div class="grid">
      <section class="block">
        <h2>Messages</h2>
        <div class="messages">
          {% if call.messages and call.messages|length %}
            {% for m in call.messages %}
              <div class="msg">
                <div class="role">{{ m.role }}</div>
                <div class="bubble">{{ m.content }}</div>
              </div>
            {% endfor %}
          {% else %}
            <div class="msg"><div class="bubble">No messages.</div></div>
          {% endif %}
        </div>
      </section>

      <section class="block">
        <h2>Details</h2>
        <div class="kv">
          <div>Phone</div><div>{{ call.phone }}</div>
          {% if call.contact %}
            <div>Assigned</div><div><span class="chip">{{ call.contact.name }} — {{ call.contact.phone }}</span></div>
          {% endif %}
          {% if call.location %}
            <div>Location</div><div>lat {{ call.location.latitude }}, lng {{ call.location.longitude }}</div>
          {% endif %}
        </div>
      </section>
    </div>

    <section class="block">
      <h2>Raw Info</h2>
      <pre style="white-space:pre-wrap;margin:0">{{ call.info | tojson(indent=2) }}</pre>
    </section>
  </div>
</body>
</html>


